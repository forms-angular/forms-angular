var fng;!function(e){var t;!function(e){function t(e,t,n,r,a,i,o,s,l){var c=i,d={master:{},fngInvalidRequired:"fng-invalid-required",allowLocationChange:!0};angular.extend(e,o.parsePathFunc()(n.$$path)),e.modelNameDisplay=c.modelNameDisplay||r("titleCase")(e.modelName),t.$broadcast("fngFormLoadStart",e),s.decorateScope(e,s,l,c),l.decorateScope(e,a,l,d),l.fillFormWithBackendSchema(e,s,l,d);for(var u=0;u<c.modelControllers.length;u++)c.modelControllers[u].onBaseCtrlReady&&c.modelControllers[u].onBaseCtrlReady(e)}t.$inject=["$scope","$rootScope","$location","$filter","$uibModal","$data","routingService","formGenerator","recordHandler"],e.BaseCtrl=t}(t=e.controllers||(e.controllers={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(e,t){e.yes=function(){t.close(!0)},e.no=function(){t.close(!1)},e.cancel=function(){t.dismiss("cancel")}}t.$inject=["$scope","$uibModalInstance"],e.SaveChangesModalCtrl=t}(t=e.controllers||(e.controllers={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(e,t,n,r){e.models=[],t.get("/api/models").success(function(t){e.models=t}).error(function(){n.path("/404")}),e.newUrl=function(e){return r.buildUrl(e+"/new")},e.listUrl=function(e){return r.buildUrl(e)}}t.$inject=["$scope","$http","$location","routingService"],e.ModelCtrl=t}(t=e.controllers||(e.controllers={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(e,t,n,r,a,i,o){function s(n,r,i){var o,s={};n+="Ctrl",s.$scope=t.modelControllers[r]=e.$new();try{a(n,s),o=e.routing.newRecord?"creating":e.routing.id?"editing":"listing",angular.isObject(s.$scope.contextMenu)&&angular.forEach(s.$scope.contextMenu,function(t){t.divider?i=!0:t[o]&&(i&&(i=!1,e.items.push({divider:!0})),e.items.push(t))})}catch(l){/is not a function, got undefined/.test(l.message)||console.log("Unable to instantiate "+n+" - "+l.message)}}e.items=[],e.isCollapsed=!0,e.showShortcuts=!1,e.shortcuts=[{key:"?",act:"Show shortcuts"},{key:"/",act:"Jump to search"},{key:"Ctrl+Shift+S",act:"Save the current record"},{key:"Ctrl+Shift+Esc",act:"Cancel changes on the current record"},{key:"Ctrl+Shift+Ins",act:"Create a new record"},{key:"Ctrl+Shift+X",act:"Delete the current record"}],e.markupShortcut=function(e){return'<span class="key">'+e.split("+").join('</span> + <span class="key">')+"</span>"},e.globalShortcuts=function(t){function n(e){var n=document.getElementById(e);n&&(n.disabled||setTimeout(function(){n.click()}),t.preventDefault())}function r(e){var t=(e.target||e.srcElement).tagName;return!("INPUT"==t||"SELECT"==t||"TEXTAREA"==t)}if(191===t.keyCode&&(r(t)||t.ctrlKey&&!t.altKey&&!t.metaKey))if(t.ctrlKey||!t.shiftKey){var a=document.getElementById("searchinput");a&&(a.focus(),t.preventDefault())}else e.showShortcuts=!0;else 83===t.keyCode&&t.ctrlKey&&t.shiftKey&&!t.altKey&&!t.metaKey?n("saveButton"):27===t.keyCode&&(t.ctrlKey&&t.shiftKey&&!t.altKey&&!t.metaKey||e.showShortcuts)?t.ctrlKey&&t.shiftKey&&!t.altKey&&!t.metaKey?n("cancelButton"):e.showShortcuts=!1:45===t.keyCode&&t.ctrlKey&&t.shiftKey&&!t.altKey&&!t.metaKey?n("newButton"):88===t.keyCode&&t.ctrlKey&&t.shiftKey&&t.altKey&&!t.metaKey&&n("deleteButton")},e.css=function(e,t){var n;return n="function"==typeof o[e]?o[e](t):"error text-error"},e.$on("$locationChangeSuccess",function(){if(e.routing=i.parsePathFunc()(n.$$path),e.items=[],e.routing.analyse)e.contextMenu="Report",e.items=[{broadcast:"exportToPDF",text:"PDF"},{broadcast:"exportToCSV",text:"CSV"}];else if(e.routing.modelName){angular.forEach(t.modelControllers,function(e){e.$destroy()}),t.modelControllers=[],t.record={},t.disableFunctions={},t.dataEventFunctions={},delete t.dropDownDisplay,delete t.modelNameDisplay;var a=r("titleCase")(e.routing.modelName,!0),o=!1;s(a,0,o),e.routing.formName&&s(a+r("titleCase")(e.routing.formName,!0),1,o),e.contextMenu=t.dropDownDisplay||t.modelNameDisplay||r("titleCase")(e.routing.modelName,!1)}}),e.doClick=function(t,n){var r=angular.element(n.target),a=e.items[t];if(a.divider||r.parent().hasClass("disabled"))n.preventDefault();else if(a.broadcast)e.$broadcast(a.broadcast);else{var i=a.args||[],o=a.fn;switch(i.length){case 0:o();break;case 1:o(i[0]);break;case 2:o(i[0],i[1]);break;case 3:o(i[0],i[1],i[2]);break;case 4:o(i[0],i[1],i[2],i[3])}}},e.isHidden=function(t){return e.items[t].isHidden?e.items[t].isHidden():!1},e.isDisabled=function(t){return e.items[t].isDisabled?e.items[t].isDisabled():!1},e.buildUrl=function(e){return i.buildUrl(e)},e.dropdownClass=function(t){var n=e.items[t],r="";return n.divider?r="divider":e.isDisabled(t)&&(r="disabled"),r}}t.$inject=["$scope","$data","$location","$filter","$controller","routingService","cssFrameworkService"],e.NavCtrl=t}(t=e.controllers||(e.controllers={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(e,t,n,r){var a,i="";a=function(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),!e}(),e.searchPlaceholder=a?"Ctrl + / to Search":"Search",e.handleKey=function(t){if(27===t.keyCode&&e.searchTarget&&e.searchTarget.length>0)e.searchTarget="";else if(e.results.length>0)switch(t.keyCode){case 38:e.focus>0&&e.setFocus(e.focus-1),"function"==typeof t.preventDefault&&t.preventDefault();break;case 40:e.results.length>e.focus+1&&e.setFocus(e.focus+1),"function"==typeof t.preventDefault&&t.preventDefault();break;case 13:null!=e.focus&&e.selectResult(e.focus)}},e.setFocus=function(t){null!==e.focus&&delete e.results[e.focus].focussed,e.results[t].focussed=!0,e.focus=t},e.selectResult=function(t){var a=e.results[t],i=r.prefix()+"/"+a.resource+"/"+a.id+"/edit";a.resourceTab&&(i+="/"+a.resourceTab),n.url(i)},e.resultClass=function(t){var n="search-result";return e.results&&e.results[t].focussed&&(n+=" focus"),n};var o=function(){e.moreCount=0,e.errorClass="",e.results=[],e.focus=null};e.$watch("searchTarget",function(n){n&&n.length>0?(i=n,t.get("/api/search?q="+n).success(function(t){i===n&&(e.searchTarget.length>0?(e.results=t.results,e.moreCount=t.moreCount,t.results.length>0&&(e.errorClass="",e.setFocus(0)),e.errorClass=0===e.results.length?"error has-error":""):o())}).error(function(e,t){console.log("Error in searchbox.js : "+e+" (status="+t+")")})):o()},!0),e.$on("$routeChangeStart",function(){e.searchTarget=""})}t.$inject=["$scope","$http","$location","routingService"],e.SearchCtrl=t}(t=e.controllers||(e.controllers={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(){return{restrict:"AE",replace:!0,template:'<li ng-show="items.length > 0" class="mcdd" uib-dropdown> <a uib-dropdown-toggle>  {{contextMenu}} <b class="caret"></b> </a> <ul class="uib-dropdown-menu dropdown-menu">  <li ng-repeat="choice in items" ng-hide="isHidden($index)" ng-class="dropdownClass($index)">   <a ng-show="choice.text" class="dropdown-option" ng-href="{{choice.url}}" ng-click="doClick($index, $event)">    {{choice.text}}   </a>  </li> </ul></li>'}}e.modelControllerDropdown=t}(t=e.directives||(e.directives={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(){return{restrict:"E",template:'<div id="display-error" ng-show="errorMessage" ng-class="css(\'rowFluid\')">  <div class="alert alert-error col-lg-offset-3 offset3 col-lg-6 col-xs-12 span6 alert-warning alert-dismissable">    <button type="button" class="close" ng-click="dismissError()">Ã—</button>    <h4>{{alertTitle}}</h4>    <div ng-bind-html="errorMessage"></div>  </div></div>'}}e.errorDisplay=t}(t=e.directives||(e.directives={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(e,t){return{restrict:"E",scope:{dataSrc:"&model"},link:function(n,r,a){var i=a.ref,o=a.form;n.readonly=a.readonly,o=o?o+"/":"",a.text&&a.text.length>0&&(n.text=a.text);var s=n.$parent.$index;n.$watch("dataSrc()",function(r){r&&("undefined"!=typeof s&&angular.isArray(r)&&(r=r[s]),n.link=e.buildUrl(i+"/"+o+r+"/edit"),n.text||t.getListAttributes(i,r).success(function(e){e.success===!1?n.text=e.err:n.text=e.list}).error(function(e,t){n.text="Error "+e+": "+t}))},!0)},template:function(e,t){return t.readonly?'<span class="fng-link">{{text}}</span>':'<a href="{{ link }}" class="fng-link">{{text}}</a>'}}}t.$inject=["routingService","SubmissionsService"],e.fngLink=t}(t=e.directives||(e.directives={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(e,t,r,a,i,o,s,l){return{restrict:"EA",link:function(c,d,u){var f=[],m=n.N,p=function(e,t,n,r,a){function i(){var t;if(angular.isArray(c[e.options]))t={repeat:e.options,value:"option"};else{if(!c[e.options]||!angular.isArray(c[e.options].values))throw new Error("Invalid enumeration setup in field "+e.name);t=angular.isArray(c[e.options].labels)?{repeat:e.options+".values",value:e.options+".values[$index]",label:e.options+".labels[$index]"}:{repeat:e.options+".values",value:e.options+".values[$index]"}}return t}var s;if(!t){var d=(a.model||"record")+".";if(t=d,a.subschema&&-1!==e.name.indexOf(".")){var u=e.name,f=a.subschemaroot,m=u.slice(f.length+1);a.index?(t+=f+"["+a.index+"]."+m,r="f_"+t.slice(d.length).replace(/(\.|\[|\]\.)/g,"-")):(t+=f,a.subkey?(r=t.slice(d.length).replace(/\./g,"-")+"-subkey"+a.subkeyno+"-"+m,t+="[$_arrayOffset_"+f.replace(/\./g,"_")+"_"+a.subkeyno+"]."+m):(t+="[$index]."+m,r=null,s=u.replace(/\./g,"-")))}else t+=e.name}var p,v,g=l.allInputsVars(c,e,a,t,r,s),h=g.common,b=n||e.required?" required":"";switch(e.type){case"select":e.select2?(h+='class="fng-select2'+g.formControl+g.compactClass+g.sizeClassBS2+'"',h+=e.readonly?" readonly":"",h+=e.required?' ng-required="true"':"",h+=e.add?" "+e.add+" ":"",e.select2.fngAjax?"bs2"===o.framework()?(p='<div class="input-append">',p+='<input ui-select2="'+e.select2.fngAjax+'" '+h+">",p+='<button class="btn" type="button" data-select2-open="'+r+'" ng-click="openSelect2($event)"><i class="icon-search"></i></button>',p+="</div>"):(p='<div class="input-group">',p+='<input ui-select2="'+e.select2.fngAjax+'" '+h+">",p+='<span class="input-group-addon'+g.compactClass+'" data-select2-open="'+r+'" ',p+='    ng-click="openSelect2($event)"><i class="glyphicon glyphicon-search"></i></span>',p+="</div>"):e.select2&&(p='<input ui-select2="'+e.select2.s2query+'" '+h+">")):(h+=e.readonly?"disabled ":"",h+=e.add?" "+e.add+" ":"",p="<select "+h+'class="'+g.formControl.trim()+g.compactClass+g.sizeClassBS2+'" '+b+">",n||(p+="<option></option>"),angular.isArray(e.options)?angular.forEach(e.options,function(e){p+=_.isObject(e)?'<option value="'+(e.val||e.id)+'">'+(e.label||e.text)+"</option>":"<option>"+e+"</option>"}):(v=i(),p+='<option ng-repeat="option in '+v.repeat+'"',p+=v.label?' value="{{'+v.value+'}}"> {{ '+v.label+" }} </option> ":">{{"+v.value+"}}</option> "),p+="</select>");break;case"link":p='<fng-link model="'+t+'" ref="'+e.ref+'"',e.form&&(p+=' form="'+e.form+'"'),e.linkText&&(p+=' text="'+e.linkText+'"'),e.readonly&&(p+=' readonly="true"'),p+="></fng-link>";break;case"radio":p="",h+=b+(e.readonly?" disabled ":" ");var y="vertical"===a.formstyle||"inline"!==a.formstyle&&!e.inlineRadio;if(angular.isArray(e.options))a.subschema&&(h=h.replace('name="','name="{{$index}}-')),angular.forEach(e.options,function(e){p+="<input "+h+'type="radio"',p+=' value="'+e+'">'+e,y&&(p+="<br />")});else{var w=y?"div":"span";a.subschema&&(h=h.replace("$index","$parent.$index").replace('name="','name="{{$parent.$index}}-')),v=i(),p+="<"+w+' ng-repeat="option in '+v.repeat+'"><input '+h+' type="radio" value="{{'+v.value+'}}"> {{',p+=v.label||v.value,p+=" }} </"+w+"> "}break;case"checkbox":h+=b+(e.readonly?" disabled ":" "),p="bs3"===o.framework()?'<div class="checkbox"><input '+h+'type="checkbox"></div>':l.generateSimpleInput(h,e,a);break;default:h+=l.addTextInputMarkup(g,e,b),"textarea"===e.type?(e.rows&&(h+="auto"===e.rows?'msd-elastic="\n" class="ng-animate" ':'rows = "'+e.rows+'" '),"ckEditor"===e.editor&&(h+='ckeditor = "" ',"bs3"===o.framework()&&(g.sizeClassBS3="col-xs-12")),p="<textarea "+h+" />"):p=l.generateSimpleInput(h,e,a)}return l.inputChrome(p,e,a,g)},v=function(e){var t;switch(e){case"horizontal":t="form-horizontal";break;case"vertical":t="";break;case"inline":t="form-inline";break;case"horizontalCompact":t="form-horizontal compact";break;default:t="form-horizontal compact"}return t},g=function(e){var t={before:"",after:""};if("function"==typeof e.containerType)t=e.containerType(e);else switch(e.containerType){case"tab":for(var n=-1,r=0;r<c.tabs.length;r++)if(c.tabs[r].title===e.title){n=r;break}n>=0?(t.before="<uib-tab select=\"updateQueryForTab('"+e.title+'\')" heading="'+e.title+'"',n>0&&(t.before+='active="tabs['+n+'].active"'),t.before+=">",t.after="</uib-tab>"):(t.before="<p>Error!  Tab "+e.title+" not found in tab list</p>",t.after="");break;case"tabset":t.before="<uib-tabset>",t.after="</uib-tabset>";break;case"well":t.before='<div class="well">',e.title&&(t.before+="<h4>"+e.title+"</h4>"),t.after="</div>";break;case"well-large":t.before='<div class="well well-lg well-large">',t.after="</div>";break;case"well-small":t.before='<div class="well well-sm well-small">',t.after="</div>";break;case"fieldset":t.before="<fieldset>",e.title&&(t.before+="<legend>"+e.title+"</legend>"),t.after="</fieldset>";break;case void 0:break;case null:break;case"":break;default:if(t.before='<div class="'+e.containerType+'">',e.title){var a=e.titleTagOrClass||"h4";a.match(/h[1-6]/)?t.before+="<"+a+">"+e.title+"</"+a+">":t.before+='<p class="'+a+'">'+e.title+"</p>"}t.after="</div>"}return t},h=function(e,t){var n=l.fieldChrome(c,e,t),r=n.template;if(e.schema){var a=e.name.replace(/\./g,"_"),i="$_schema_"+a;if(c[i]=e.schema,e.schema)if(e.subkey){e.subkey.path=e.name,c[i+"_subkey"]=e.subkey;for(var s=angular.isArray(e.subkey)?e.subkey:[e.subkey],d=0;d<s.length;d++){var u=g(s[d]);r+=u.before,r+=y(e.schema,null,{subschema:"true",formstyle:t.formstyle,subkey:i+"_subkey",subkeyno:d,subschemaroot:e.name}),r+=u.after}f.push(e)}else t.subschema?console.log("Attempts at supporting deep nesting have been removed - will hopefully be re-introduced at a later date"):(r+='<div class="schema-head">'+e.label,e.unshift&&(r+='<button id="unshift_'+e.id+'_btn" class="add-btn btn btn-default btn-xs btn-mini form-btn" ng-click="unshift(\''+e.name+'\',$event)"><i class="'+l.glyphClass()+'-plus"></i> Add</button>'),r+='</div><div ng-form class="'+("bs2"===o.framework()?"row-fluid ":"")+v(e.formStyle)+'" name="form_'+a+'{{$index}}" class="sub-doc well" id="'+e.id+'List_{{$index}}"  ng-repeat="subDoc in '+(t.model||"record")+"."+e.name+' track by $index">   <div class="'+("bs2"===o.framework()?"row-fluid":"row")+' sub-doc">',(!e.noRemove||e.customSubDoc)&&(r+='   <div class="sub-doc-btns">',e.customSubDoc&&(r+=e.customSubDoc),e.noRemove||(r+='<button name="remove_'+e.id+'_btn" class="remove-btn btn btn-mini btn-default btn-xs form-btn" ng-click="remove(\''+e.name+'\',$index,$event)"><i class="'+l.glyphClass()+'-minus"></i> Remove</button>'),r+="  </div> "),r+=y(e.schema,!1,{subschema:"true",formstyle:e.formStyle,model:t.model,subschemaroot:e.name}),r+="   </div></div>",(!e.noAdd||e.customFooter)&&(r+='<div class = "schema-foot">',e.customFooter&&(r+=e.customFooter),e.noAdd||(r+='<button id="add_'+e.id+'_btn" class="add-btn btn btn-default btn-xs btn-mini form-btn" ng-click="add(\''+e.name+'\',$event)"><i class="'+l.glyphClass()+'-plus"></i> Add</button>'),r+="</div>"))}else{var m=l.controlDivClasses(t);if(e.array){if(m.push("fng-array"),"inline"===t.formstyle)throw new Error("Cannot use arrays in an inline form");r+=l.label(c,e,"link"!==e.type,t),r+=l.handleArrayInputAndControlDiv(p(e,"link"===e.type?null:"arrayItem.x",!0,e.id+"_{{$index}}",t),m,e,t)}else r+=l.label(c,e,null,t),t.required&&console.log("*********  Options required - found it ********"),r+=l.handleInputAndControlDiv(p(e,null,t.required,e.id,t),m)}return r+=n.closeTag},b=function(e){e.type=e.type||"text",e.id?("number"==typeof e.id||e.id[0]>=0&&e.id<="9")&&(e.id="_"+e.id):e.id="f_"+e.name.replace(/\./g,"_"),e.label=void 0!==e.label?null===e.label?"":e.label:r("titleCase")(e.name.split(".").slice(-1)[0])},y=function(e,t,a){var i="";if(e)for(var o=0;o<e.length;o++){var s=e[o];0===o&&t&&!a.schema.match(/$_schema_/)&&"object"!=typeof s.add&&(s.add=s.add?" "+s.add+" ":"",-1!==s.add.indexOf("ui-date")||a.noautofocus||s.containerType||(s.add=s.add+"autofocus "));var l=!0;if(s.directive){var u=s.directive,f="<"+u+' model="'+(a.model||"record")+'"',p=d[0];b(s);for(var v=0;v<p.attributes.length;v++){var w=p.attributes[v];switch(w.nodeName){case"class":var k=w.value.replace("ng-scope","");k.length>0&&(f+=' class="'+k+'"');break;case"schema":var x=("bespoke_"+s.name).replace(/\./g,"_");c[x]=angular.copy(s),delete c[x].directive,f+=' schema="'+x+'"';break;default:f+=" "+w.nodeName+'="'+w.value+'"'}}f+=" ";var C=r("camelCase")(s.directive);for(var S in s)if(s.hasOwnProperty(S))switch(S){case"directive":break;case"schema":break;case"add":switch(typeof s.add){case"string":f+=" "+s.add;break;case"object":for(var $ in s.add)f+=" "+$+'="'+s.add[$].toString().replace(/"/g,"&quot;")+'"';break;default:throw new Error("Invalid add property of type "+typeof s.add+" in directive "+s.name)}break;case C:for(var F in s[S])f+=s.directive+"-"+F+'="'+s[S][F]+'"';break;default:f+=" fng-fld-"+S+'="'+s[S].toString().replace(/"/g,"&quot;")+'"'}for(S in a)a.hasOwnProperty(S)&&"$"!==S[0]&&"undefined"!=typeof a[S]&&(f+=" fng-opt-"+S+'="'+a[S].toString().replace(/"/g,"&quot;")+'"');f+='ng-model="'+s.name+'"></'+u+">",i+=f,l=!1}else if(s.containerType){var D=g(s);switch(s.containerType){case"tab":if(m===n.N){m=n.Forced,i+='<uib-tabset active="activeTabNo">';var E=_.findIndex(c.tabs,function(e){return e.active});c.activeTabNo=E>=0?E:0}i+=D.before,i+=y(s.content,null,a),i+=D.after;break;case"tabset":m=n.Y,i+=D.before,i+=y(s.content,null,a),i+=D.after;break;default:i+=D.before,i+=y(s.content,null,a),i+=D.after}l=!1}else if(a.subkey){var N=angular.isArray(c[a.subkey])?c[a.subkey][0].keyList:c[a.subkey].keyList;_.find(N,function(e,t){return c[a.subkey].path+"."+t===s.name})&&(l=!1)}l&&(b(s),i+=h(s,a))}else console.log("Empty array passed to processInstructions"),i="";return i},w=c.$watch(u.schema,function(r){if(r&&(r=angular.isArray(r)?r:[r],r.length>0)){w();var o="",l=u.model||"record",p=c[l];if(p=p||{},!u.subschema&&!u.model||u.forceform){c.topLevelFormName=u.name||"myForm";var g="";for(var h in u)u.hasOwnProperty(h)&&"$"!==h[0]&&-1===["name","formstyle","schema","subschema","model"].indexOf(h)&&(g+=" "+u.$attr[h]+'="'+u[h]+'"');o='<form name="'+c.topLevelFormName+'" class="'+v(u.formstyle)+' novalidate"'+g+">"}else o="";if(p===c.topLevelFormName)throw new Error("Model and Name must be distinct - they are both "+p);if(o+=y(r,!0,u),m===n.Forced&&(o+="</uib-tabset>"),o+=u.subschema?"":"</form>",d.replaceWith(e(o)(c)),f.length>0||a.modelControllers.length>0)var b=c.$watch("phase",function(e){if("ready"===e){b();for(var t=0;t<a.modelControllers.length;t++)a.modelControllers[t].onAllReady&&a.modelControllers[t].onAllReady(c);for(var n=0;n<f.length;n++){for(var r,o,s=f[n],l=angular.isArray(s.subkey)?s.subkey:[s.subkey],d=s.name.split("."),u=p;d.length>1;)u=u[d.shift()]||{};u=u[d[0]]=u[d[0]]||[];for(var m=0;m<l.length;m++){if(l[m].selectFunc){if(!c[l[m].selectFunc]||"function"!=typeof c[l[m].selectFunc])throw new Error("Subkey function "+l[m].selectFunc+" is not properly set up");r=c[l[m].selectFunc](p,s)}else{if(!l[m].keyList)throw new Error("Invalid subkey setup for "+s.name);var v=l[m].keyList;for(r=0;r<u.length;r++){o=!0;for(var g in v)if(v.hasOwnProperty(g)&&u[r][g]!==v[g]&&("undefined"==typeof u[r][g]||!u[r][g].text||u[r][g].text!==v[g])){o=!1;break}if(o)break}if(!o)switch(l[m].onNotFound){case"error":var h="Cannot find matching "+(l[m].title||l[m].path);i(function(){c.showError(h,"Unable to set up form correctly")}),r=-1;break;case"create":default:r=p[s.name].push(v)-1}}c["$_arrayOffset_"+s.name.replace(/\./g,"_")+"_"+m]=r}}}});t.$broadcast("formInputDone"),s.updateDataDependentDisplay&&p&&Object.keys(p).length>0&&s.updateDataDependentDisplay(p,null,!0,c)}},!0)}}}t.$inject=["$compile","$rootScope","$filter","$data","$timeout","cssFrameworkService","formGenerator","formMarkupHelper"];var n;!function(e){e[e.Y=0]="Y",e[e.N=1]="N",e[e.Forced=2]="Forced"}(n||(n={})),e.formInput=t}(t=e.directives||(e.directives={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(e){return{restrict:"A",templateUrl:"form-button-"+e.framework()+".html"}}t.$inject=["cssFrameworkService"],e.formButtons=t}(t=e.directives||(e.directives={}))}(fng||(fng={}));var fng;!function(e){var t;!function(t){function n(t){return{restrict:"AE",templateUrl:"search-"+t.framework()+".html",controller:e.controllers.SearchCtrl}}n.$inject=["cssFrameworkService"],t.globalSearch=n}(t=e.directives||(e.directives={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(){return function(e){var t=/([\:\-\_]+(.))/g;return e.replace(t,function(e,t,n,r){return r?n.toUpperCase():n})}}e.camelCase=t}(t=e.filters||(e.filters={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(){return function(e,t){return e&&(e=e.replace(/(_|\.)/g," ").replace(/[A-Z]/g," $&").trim().replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}),e=t?e.replace(/\s/g,""):e.replace(/\s{2,}/g," ")),e}}e.titleCase=t}(t=e.filters||(e.filters={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(){function e(e,t,n,r){function a(e){for(var t in e)t===n&&l.push(e[t]),"$parent"===t&&a(e[t])}var i,o,s,l=[],c=[];if(n="addAll"+n,"string"==typeof r)for(i=r.split(" "),o=0;o<i.length;o++)c.push(i[o]);if(a(e),void 0!==t[n]&&"string"==typeof t[n])for(i=t[n].split(" "),o=0;o<i.length;o++)0===i[o].indexOf("class=")?c.push(i[o].substring(6,i[o].length)):l.push(i[o]);return r=c.length>0?' class="'+c.join(" ")+'" ':" ",s=l.length>0?l.join(" ")+" ":"",r+s}this.getAddAllGroupOptions=function(t,n,r){return e(t,n,"Group",r)},this.getAddAllFieldOptions=function(t,n,r){return e(t,n,"Field",r)},this.getAddAllLabelOptions=function(t,n,r){return e(t,n,"Label",r)},this.addAll=function(e,t,n,r){var a="getAddAll"+t+"Options";return this[a](e,r,n)||[]}}e.addAllService=t}(t=e.services||(e.services={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(){var e={framework:"bs3"};return{setOptions:function(t){angular.extend(e,t)},$get:function(){return{framework:function(){return e.framework},setFrameworkForDemoWebsite:function(t){e.framework=t},span:function(t){var n;switch(e.framework){case"bs2":n="span"+t;break;case"bs3":n="col-xs-"+t}return n},offset:function(t){var n;switch(e.framework){case"bs2":n="offset"+t;break;case"bs3":n="col-lg-offset-"+t}return n},rowFluid:function(){var t;switch(e.framework){case"bs2":t="row-fluid";break;case"bs3":t="row"}return t}}}}}e.cssFrameworkService=t}(t=e.services||(e.services={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(){var e={record:{},disableFunctions:{},dataEventFunctions:{},modelControllers:[]};return e}e.$data=t}(t=e.services||(e.services={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(e,t){function n(e){var t=e;return l.templateFolder&&(t="/"!==l.templateFolder[l.templateFolder.length-1]?l.templateFolder+"/"+t:l.templateFolder+t),t}function r(e,t,r){void 0===t&&(t=""),t=t||"",angular.forEach(e,function(e){o.when(t+e.route,angular.extend(e.options||{templateUrl:n(e.templateUrl)},r))}),l.variantsForDemoWebsite&&angular.forEach(l.variantsForDemoWebsite,function(a){angular.forEach(e,function(e){o.when(t+a+e.route,angular.extend(e.options||{templateUrl:n(e.templateUrl)},r))})})}function a(e,t,n){void 0===t&&(t=""),t=t||"",angular.forEach(e,function(e){s.state(e.state,angular.extend(e.options||{url:t+e.route,templateUrl:e.templateUrl},n))})}function i(e,t,n,r,a,i){var o,s=r?"/"+r:"",l=e+"/"+n,c=i?"/"+i:"";switch(t){case"list":o=l+s;break;case"edit":o=l+s+"/"+a+"/edit"+c;break;case"new":o=l+s+"/new"+c}return o}var o,s,l={hashPrefix:"",html5Mode:!1,routing:"ngroute",prefix:""},c=[{route:"/analyse/:model/:reportSchemaName",state:"analyse::model::report",templateUrl:"base-analysis.html"},{route:"/analyse/:model",state:"analyse::model",templateUrl:"base-analysis.html"},{route:"/:model/:id/edit",state:"model::edit",templateUrl:"base-edit.html"},{route:"/:model/:id/edit/:tab",state:"model::edit::tab",templateUrl:"base-edit.html"},{route:"/:model/new",state:"model::new",templateUrl:"base-edit.html"},{route:"/:model",state:"model::list",templateUrl:"base-list.html"},{route:"/:model/:form/:id/edit",state:"model::form::edit",templateUrl:"base-edit.html"},{route:"/:model/:form/:id/edit/:tab",state:"model::form::edit::tab",templateUrl:"base-edit.html"},{route:"/:model/:form/new",state:"model::form::new",templateUrl:"base-edit.html"},{route:"/:model/:form",state:"model::form::list",templateUrl:"base-list.html"}],d=null,u={};return{start:function(n){switch(angular.extend(l,n),l.prefix[0]&&"/"!==l.prefix[0]&&(l.prefix="/"+l.prefix),t.html5Mode(l.html5Mode),""!==l.hashPrefix&&t.hashPrefix(l.hashPrefix),l.routing){case"ngroute":o=e.get("$routeProvider"),l.fixedRoutes&&r(l.fixedRoutes),r(c,l.prefix,n.add2fngRoutes);break;case"uirouter":s=e.get("$stateProvider"),l.fixedRoutes&&a(l.fixedRoutes),a(c,l.prefix,n.add2fngRoutes)}},$get:function(){return{router:function(){return l.routing},prefix:function(){return l.prefix},parsePathFunc:function(){return function(e){if(e!==d){d=e,u={newRecord:!1},l.prefix.length>0&&0===e.indexOf(l.prefix)&&(e=e.slice(l.prefix.length));var t=e.split("/");l.variants&&-1!==l.variants.indexOf(t[1])&&(u.variant=t[1],t.shift());var n=t.length;if("analyse"===t[1])u.analyse=!0,u.modelName=t[2],u.reportSchemaName=n>=4?t[3]:null;else{u.modelName=t[1];var r,a=[t[n-1],t[n-2]],i=a.indexOf("new");-1===i?(r=a.indexOf("edit"),-1!==r&&(n-=2+r,u.id=t[n])):(u.newRecord=!0,n-=1+i),(1===r||1===i)&&(u.tab=a[0]),n>2&&(u.formName=t[2])}}return u}},buildUrl:function(e){var t=l.html5Mode?"":"#";return t+=l.hashPrefix,t+=l.prefix,t[0]&&(t+="/"),t+="/"===e[0]?e.slice(1):e},buildOperationUrl:function(e,t,n,r,a){return i(l.prefix,e,t,n,r,a)},redirectTo:function(){return function(e,t,n,r,a){n.search()&&n.url(n.path());var o=i(l.prefix,e,t.modelName,t.formName,r,a);n.path(o)}}}}}}t.$inject=["$injector","$locationProvider"],e.routingService=t}(t=e.services||(e.services={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(e,t,n,r,a,i){function o(e,t,n,r,a,i,l,c){function m(e,t){var n=angular.copy(e),r=_.find(l.tabs,function(e){return e.title===n});if(!r){if(0===l.tabs.length&&l.formSchema.length>0){l.tabs.push({title:"Main",content:[],active:"Main"===l.tab||!l.tab}),r=l.tabs[0];for(var a=0;a<l.formSchema.length;a++)r.content.push(l.formSchema[a])}r=l.tabs[l.tabs.push({title:n,containerType:"tab",content:[],active:n===l.tab})-1]}r.content.push(t)}for(var v in t)if("_id"!==v&&t.hasOwnProperty(v)){var g=t[v],h=g.options||{},b=h.form||{};if(g.schema&&!b.hidden){if(i&&n){var y=[];o("Nested "+v,g.schema,y,null,v+".",!0,l,c);var w=d(v,b,a);w.schema=y,b.tab&&m(b.tab,w),void 0!==b.order?n.splice(b.order,0,w):n.push(w)}}else{if(n&&!b.hidden){var k=d(v,b,a);if(p(k.showIf,k.name,l)&&"options"!==v){var x=s(k,g,h,l,c);x.tab&&m(x.tab,x),void 0!==b.order?n.splice(b.order,0,x):n.push(x)}}r&&h.list&&u(r,h.list,v)}}r&&0===r.length&&f(e,r,n,t)}function s(a,s,c,d,u){function f(){a.options=i.suffixCleanId(a,"Options"),a.ids=i.suffixCleanId(a,"_ids"),a.hidden||i.setUpSelectOptions(c.ref,a,d,u,o)}var m;if(s.caster&&(a.array=!0,s=s.caster,angular.extend(c,s.options),s.options&&s.options.form&&angular.extend(a,s.options.form)),"String"===s.instance)c["enum"]?(a.type=a.type||"select",a.select2?(d.conversions[a.name]=a.select2,c.required&&(d.$watch("record."+a.name,function(e){l(e,a.id,a.select2,u)},!0),setTimeout(function(){l(d.record[a.name],a.id,a.select2,u)},0)),a.select2===!0&&(a.select2={}),a.select2.s2query="select2"+a.name.replace(/\./g,"_"),d[a.select2.s2query]={allowClear:!c.required,initSelection:function(e,n){function r(){function o(t,n,r){if(n)if(0===t.length)r(n);else{if(angular.isArray(n)){var a=e.context.getAttribute("ng-model"),i=a.indexOf("."+t[0]);a=a.slice(0,i),i=a.lastIndexOf("."),a=a.slice(i+1),a=/.+\[(.+)\]/.exec(a),n=n[d[a[1]]]}n=n[t.shift()],o(t,n,r)}}var s=d.record;if(s){var c=a.name.split(".");o(c,s,function(t){if(setTimeout(l(t,a.id,a.select2,u)),t)if(a.array){var r=parseInt(e.context.id.match("_[0-9].*$")[0].slice(1));t[r].x&&i.preservePristine(e,function(){n(t[r].x)})}else i.preservePristine(e,function(){n(t)})})}else t(r)}t(r)},query:function(e){for(var t={results:[]},n=e.term.toUpperCase(),r=0;r<c["enum"].length;r++)-1!==c["enum"][r].toUpperCase().indexOf(n)&&t.results.push({id:r,text:c["enum"][r]});e.callback(t)}},_.extend(d[a.select2.s2query],a.select2),a.select2===!0&&(a.select2={}),d.select2List.push(a.name)):(a.options=i.suffixCleanId(a,"Options"),d[a.options]=c["enum"])):(a.type||(a.type=-1!==a.name.toLowerCase().indexOf("password")?"password":"text"),c.match&&(a.add='pattern="'+c.match+'" '+(a.add||"")));else if("ObjectID"===s.instance)a.ref=c.ref,a.link&&a.link.linkOnly?(a.type="link",a.linkText=a.link.text,a.form=a.link.form,delete a.link):(a.type="select",a.select2||c.form&&c.form.select2?(a.select2||(a.select2=c.form.select2),a.select2===!0&&(a.select2={}),d.select2List.push(a.name),d.conversions[a.name]=a.select2,a.select2.fngAjax?(m="ajax"+a.name.replace(/\./g,""),c.required||a.placeHolder||(a.placeHolder="Select..."),d[m]={allowClear:!c.required,minimumInputLength:2,initSelection:function(t,n){var a=t.val();a&&""!==a&&r.getListAttributes(c.ref,a).success(function(r){r.success===!1&&e.path("/404");var o={id:a,text:r.list};i.preservePristine(t,function(){n(o)})}).error(d.handleHttpError)},ajax:{url:"/api/search/"+c.ref,data:function(e,t){var n,r={q:e,pageLimit:10,page:t};return"object"==typeof c.form.searchQuery?n=c.form.searchQuery:"function"==typeof c.form.searchQuery&&(n=c.form.searchQuery(d,c)),n&&_.extend(r,n),r},results:function(e){return{results:e.results,more:e.moreCount>0
}}}},_.extend(d[m],a.select2),a.select2.fngAjax=m):(a.select2===!0&&(a.select2={}),a.select2.s2query="select2"+a.name.replace(/\./g,"_"),d["select2"+a.select2.s2query]={allowClear:!c.required,initSelection:function(e,t){var n=e.val();if(""!==n&&d[a.ids].length>0){var r=i.convertIdToListValue(n,d[a.ids],d[a.options],a.name),o={id:n,text:r};t(o)}},query:function(e){for(var t={results:[]},n=e.term.toUpperCase(),r=0;r<d[a.options].length;r++)-1!==d[a.options][r].toUpperCase().indexOf(n)&&t.results.push({id:d[a.ids][r],text:d[a.options][r]});e.callback(t)}},_.extend(d[a.select2.s2query],a.select2),f())):a.directive&&a[n("camelCase")(a.directive)]&&a[n("camelCase")(a.directive)].fngAjax||f());else if("Date"===s.instance)a.type||(a.readonly?a.type="text":(a.type="text",a.add="ui-date ui-date-format datepicker-popup-fix "));else if("boolean"===s.instance.toLowerCase())a.type="checkbox";else{if("Number"!==s.instance)throw new Error("Field "+a.name+" is of unsupported type "+s.instance);a.type="number",c.min&&(a.add='min="'+c.min+'" '+(a.add||"")),c.max&&(a.add='max="'+c.max+'" '+(a.add||"")),a.step&&(a.add='step="'+a.step+'" '+(a.add||""))}return c.required&&(a.required=!0),c.readonly&&(a.readonly=!0),a}function l(e,t,n,r){var a="#"+(n?"cg_":"")+t,i=angular.element(document.querySelector(a));e?i.removeClass(r.fngInvalidRequired):i.addClass(r.fngInvalidRequired)}function c(e,t){for(var n=e.split("."),r=t.record,a=0,i=n.length;i>a;a++)r[n[a]]||(a===i-1?r[n[a]]=[]:r[n[a]]={}),r=r[n[a]];return r}var d=function(e,t,n){return t.name=n+e,t},u=function(e,t,n){"object"==typeof t?(t.name=n,e.push(t)):e.push({name:n})},f=function(e,t,n,r){if(n){for(var a=0,i=n.length;i>a;a++)if("text"===n[a].type){t.push({name:n[a].name});break}0===t.length&&0!==n.length&&t.push({name:n[0].name})}if(0===t.length){for(var o in r)if("_id"!==o&&r.hasOwnProperty(o)){t.push({name:o});break}if(0===t.length)throw new Error("Unable to generate a title for "+e)}},m=function(e,t,n){function r(e){var r=e;if("string"==typeof e&&"$"===e.slice(0,1)){var a=e.split(".");switch(a.length){case 1:r=i.getListData(t,e.slice(1),n);break;case 2:r=i.getListData(t,a[1],n);break;default:throw new Error("Unsupported showIf format")}}return r}var a,o=r(e.lhs),s=r(e.rhs);switch(e.comp){case"eq":a=o===s;break;case"ne":a=o!==s;break;default:throw new Error("Unsupported comparator "+e.comp)}return a},p=function(e,t,n){function r(e){if("string"==typeof e&&"$"===e.slice(0,1)){var r=e.slice(1),i=n.dataDependencies[r]||[];i.push(t),n.dataDependencies[r]=i,a+=1}}var a=0,i=!0;return e&&(r(e.lhs),r(e.rhs),0!==a||m(e,void 0,n.select2List)||(i=!1)),i};return{generateEditUrl:function(e,t){return a.buildUrl(t.modelName+"/"+(t.formName?t.formName+"/":"")+e._id+"/edit")},generateNewUrl:function(e){return a.buildUrl(e.modelName+"/"+(e.formName?e.formName+"/":"")+"new")},handleFieldType:s,handleSchema:o,updateDataDependentDisplay:function(e,t,n,r){var a,i,o,s,l,c;for(var d in r.dataDependencies)if(r.dataDependencies.hasOwnProperty(d)){var u=d.split(".");if(1===u.length){if(n||!t||e[d]!==t[d])for(a=r.dataDependencies[d],i=0;i<a.length;i+=1){var f=a[i];for(o=0;o<r.formSchema.length;o+=1)r.formSchema[o].name===f&&(l=angular.element(document.querySelector("#cg_"+r.formSchema[o].id)),m(r.formSchema[o].showIf,e,r.select2List)?l.removeClass("ng-hide"):l.addClass("ng-hide"))}}else{if(2!==u.length)throw new Error("You can only go down one level of subdocument with showIf");if(void 0===c&&(c=!0),e[u[0]])for(s=0;s<e[u[0]].length;s++)if(n||!t||!t[u[0]]||!t[u[0]][s]||e[u[0]][s][u[1]]!==t[u[0]][s][u[1]])for(a=r.dataDependencies[d],i=0;i<a.length;i+=1){var p=a[i].split(".");if(2!==p.length)throw new Error("Conditional display must control dependent fields at same level ");for(o=0;o<r.formSchema.length;o+=1)if(r.formSchema[o].name===p[0])for(var v=r.formSchema[o].schema,g=0;g<v.length;g++)v[g].name===a[i]&&(l=angular.element(document.querySelector("#f_"+p[0]+"List_"+s+" #cg_f_"+a[i].replace(".","_"))),0===l.length?l=angular.element(document.querySelector("#f_elements-"+s+"-"+p[1])):c=!1,l.length>0&&(m(r.formSchema[o].schema[g].showIf,e[u[0]][s],r.select2List)?l.show():l.hide()))}}}return c},add:function(e,t,n){var r=c(e,n);r.push({}),n.setFormDirty(t)},unshift:function(e,t,n){var r=c(e,n);r.unshift({}),n.setFormDirty(t)},remove:function(e,t,n,r){for(var a=e.split("."),i=r.record,o=0,s=a.length;s>o;o++)i=i[a[o]];i.splice(t,1),r.setFormDirty(n)},hasError:function(e,t,n,r){var a=!1;if(r){var i=r[r.topLevelFormName];if("null"!==e&&(i=i[e.replace("$index",n)]),i){var o=i[t];o&&o.$invalid&&(o.$dirty?a=!0:angular.forEach(o.$validators,function(e,t){"required"!==t&&o.$error[t]&&(a=!0)}))}}else console.log("hasError called with no scope! ",e,t,n);return a},decorateScope:function(e,t,n,r){e.record=r.record,e.phase="init",e.disableFunctions=r.disableFunctions,e.dataEventFunctions=r.dataEventFunctions,e.topLevelFormName=void 0,e.formSchema=[],e.tabs=[],e.listSchema=[],e.recordList=[],e.dataDependencies={},e.select2List=[],e.conversions={},e.pageSize=60,e.pagesLoaded=0,r.baseScope=e,e.generateEditUrl=function(n){return t.generateEditUrl(n,e)},e.generateNewUrl=function(){return t.generateNewUrl(e)},e.scrollTheList=function(){return n.scrollTheList(e)},e.getListData=function(t,r){return n.getListData(t,r,e.select2List)},e.setPristine=function(t){t&&e.dismissError(),e[e.topLevelFormName]&&e[e.topLevelFormName].$setPristine()},e.skipCols=function(e){return e>0?"col-md-offset-3":""},e.setFormDirty=function(e){if(e){var t=angular.element(e.target).inheritedData("$formController");t.$setDirty()}else console.log("setFormDirty called without an event (fine in a unit test)")},e.add=function(n,r){return t.add(n,r,e)},e.hasError=function(n,r,a){return t.hasError(n,r,a,e)},e.unshift=function(n,r){return t.unshift(n,r,e)},e.remove=function(n,r,a){return t.remove(n,r,a,e)},e.openSelect2=function(e){$("#"+$(e.currentTarget).data("select2-open")).select2("open")},e.toJSON=function(e){return"The toJSON function is deprecated - use the json filter instead\n\n"+JSON.stringify(e,null,2)+"\n\n*** The toJSON function is deprecated - use the json filter instead ***"},e.baseSchema=function(){return e.tabs.length?e.tabs:e.formSchema}}}}e.formGenerator=t,t.$inject=["$location","$timeout","$filter","SubmissionsService","routingService","recordHandler"]}(t=e.services||(e.services={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(e,t,n){function r(e,t){function n(e){var n=e;if("string"==typeof e)if("$"===e.slice(0,1)){n=(t||"record")+".";var r=e.slice(1).split(".");if(r.length>1){var a=r.pop();n+=r.join(".")+"[$index]."+a}else n+=e.slice(1)}else n="'"+e+"'";return n}var r=["eq","ne","gt","gte","lt","lte"],a=["===","!==",">",">=","<","<="],i=r.indexOf(e.comp);if(-1===i)throw new Error("Invalid comparison in showWhen");return n(e.lhs)+a[i]+n(e.rhs)}function a(){return"bs2"===e.framework()?"icon":"glyphicon glyphicon"}var i=function(e){return!e||"undefined"===e||-1===["vertical","inline"].indexOf(e)};return{isHorizontalStyle:i,fieldChrome:function(a,o,s){var l="",c="",d="",u="";if(o.showWhen=o.showWhen||o.showwhen,o.showWhen&&(u+="string"==typeof o.showWhen?'ng-show="'+o.showWhen+'"':'ng-show="'+r(o.showWhen,s.model)+'"'),u+=' id="cg_'+o.id.replace(/\./g,"-")+'"',"bs3"===e.framework()){l="form-group","vertical"===s.formstyle&&"block-level"!==o.size&&(c+='<div class="row">',l+=" col-sm-"+t.sizeAsNumber(o.size),d+="</div>");var f,m=null,p=o.name.split(".");s&&"undefined"!=typeof s.subkeyno?f=s.subschemaroot.replace(/\./g,"-")+"-subkey"+s.subkeyno+"-"+p[p.length-1]:s.subschema?(m="form_"+p.slice(0,-1).join("_")+"$index",f=o.name.replace(/\./g,"-")):f="f_"+o.name.replace(/\./g,"_"),c+="<div"+n.addAll(a,"Group",l,s)+" ng-class=\"{'has-error': hasError('"+m+"','"+f+"', $index)}\"",d+="</div>"}else i(s.formstyle)?(c+="<div"+n.addAll(a,"Group","control-group",s),d="</div>"):(c+="<span ",d="</span>");return c+=(u||"")+">",{template:c,closeTag:d}},label:function(t,r,o,s){var l="";if("bs3"===e.framework()||"inline"!==s.formstyle&&""!==r.label||o){l="<label";var c="control-label";i(s.formstyle)?(l+=' for="'+r.id+'"',"undefined"!=typeof r.labelDefaultClass?c+=" "+r.labelDefaultClass:"bs3"===e.framework()&&(c+=" col-sm-3")):"inline"===s.formstyle&&(l+=' for="'+r.id+'"',c+=" sr-only"),l+=n.addAll(t,"Label",null,s)+' class="'+c+'">'+r.label,o&&(l+=' <i id="add_'+r.id+'" ng-click="add(\''+r.name+'\',$event)" class="'+a()+'-plus-sign"></i>'),l+="</label>"}return l},glyphClass:a,allInputsVars:function(r,a,i,o,s,l){var c,d=a.placeHolder,u="",f="",m="",p="";return"bs3"===e.framework()?(u=-1===["horizontal","vertical","inline"].indexOf(i.formstyle)?" input-sm":"",f="col-sm-"+t.sizeAsNumber(a.size),p=" form-control"):m=a.size?" input-"+a.size:"","inline"===i.formstyle&&(d=d||a.label),c='ng-model="'+o+'"'+(s?' id="'+s+'" name="'+s+'" ':' name="'+l+'" '),c+=d?'placeholder="'+d+'" ':"",a.popup&&(c+='title="'+a.popup+'" '),c+=n.addAll(r,"Field",null,i),{common:c,sizeClassBS3:f,sizeClassBS2:m,compactClass:u,formControl:p}},inputChrome:function(t,n,r,a){return"bs3"===e.framework()&&i(r.formstyle)&&"checkbox"!==n.type&&(t='<div class="bs3-input '+a.sizeClassBS3+'">'+t+"</div>"),n.helpInline&&(t+='<span class="'+("bs2"===e.framework()?"help-inline":"help-block")+'">'+n.helpInline+"</span>"),t+='<div ng-if="'+(r.name||"myForm")+"."+n.id+'.$dirty" class="help-block"> <div ng-messages="'+(r.name||"myForm")+"."+n.id+'.$error">  <div ng-messages-include="error-messages.html">  </div> </div></div>',n.help&&(t+='<span class="help-block">'+n.help+"</span>"),t},generateSimpleInput:function(t,n,r){var a="<input "+t+'type="'+n.type+'"';return"inline"!==r.formstyle||"bs2"!==e.framework()||n.size||(a+='class="input-small"'),a+=" />"},controlDivClasses:function(t){var n=[];return i(t.formstyle)&&n.push("bs2"===e.framework()?"controls":"col-sm-9"),n},handleInputAndControlDiv:function(e,t){return t.length>0&&(e='<div class="'+t.join(" ")+'">'+e+"</div>"),e},handleArrayInputAndControlDiv:function(t,n,r,i){var o="<div ";return"bs3"===e.framework()&&(o+='ng-class="skipCols($index)" '),o+='class="'+n.join(" ")+'" id="'+r.id+'List" ',o+='ng-repeat="arrayItem in '+(i.model||"record")+"."+r.name+' track by $index">',o+=t,"link"!==r.type&&(o+="<i ng-click=\"remove('"+r.name+'\',$index,$event)" id="remove_'+r.id+'_{{$index}}" class="'+a()+'-minus-sign"></i>'),o+="</div>"},addTextInputMarkup:function(e,t,n){var r="",a=e.formControl.trim()+e.compactClass+e.sizeClassBS2+(t["class"]?" "+t["class"]:"");return 0!==a.length&&(r+='class="'+a+'"'),t.add&&(r+=" "+t.add+" "),r+=n+(t.readonly?" readonly":"")+" "}}}t.$inject=["cssFrameworkService","inputSizeHelper","addAllService"],e.formMarkupHelper=t}(t=e.services||(e.services={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(){var e=[1,2,4,6,8,10,12],t=["mini","small","medium","large","xlarge","xxlarge","block-level"],n=2;return{sizeMapping:e,sizeDescriptions:t,defaultSizeOffset:n,sizeAsNumber:function(r){return e[r?t.indexOf(r):n]}}}e.inputSizeHelper=t}(t=e.services||(e.services={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(e){return{extractFromAttr:function(e,t){function n(e){var t=e.replace(/&quot;/g,'"');return"true"===t?t=!0:"false"===t?t=!1:!isNaN(parseFloat(t))&&isFinite(t)&&(t=parseFloat(t)),t}var r={},a={formStyle:e.formstyle},i={},o=t?t.length:0;for(var s in e)e.hasOwnProperty(s)&&("fngFld"===s.slice(0,6)?r[s.slice(6).toLowerCase()]=n(e[s]):"fngOpt"===s.slice(0,6)?a[s.slice(6).toLowerCase()]=n(e[s]):t&&s.slice(0,o)===t&&(i[s.slice(o).toLowerCase()]=n(e[s])));return{info:r,options:a,directiveOptions:i}},buildInputMarkup:function(t,n,r,a,i,o,s){var l,c,d,u=e.fieldChrome(t,r,a,' id="cg_'+r.id+'"'),f=e.controlDivClasses(a),m=u.template+e.label(t,r,i,a);if(i?(l="arrayItem"+(o?".x":""),c=r.id+"_{{$index}}",d=r.name+"_{{$index}}"):(l=n+"."+r.name,c=r.id,d=r.name),a.subschema&&-1!==r.name.indexOf(".")){var p=n+".",v=r.name,g=a.subschemaroot,h=v.slice(g.length+1);l=p,a.index?(l+=g+"["+a.index+"]."+h,c="f_"+l.slice(p.length).replace(/(\.|\[|\]\.)/g,"-")):(l+=g,a.subkey?(c=l.slice(p.length).replace(/\./g,"-")+"-subkey"+a.subkeyno+"-"+h,l+="[$_arrayOffset_"+g.replace(/\./g,"_")+"_"+a.subkeyno+"]."+h):(l+="[$index]."+h,c=null,d=v.replace(/\./g,"-")))}var b=e.allInputsVars(t,r,a,l,c,d);return m+=e["handle"+(i?"Array":"")+"InputAndControlDiv"](e.inputChrome(s(b),r,a,b),f,r,a),m+=u.closeTag},findIdInSchemaAndFlagNeedX:function t(e,n){for(var r=!1,a=0;a<e.length;a++){var i=e[a];if(i.id===n){i.needsX=!0,r=!0;break}if(i.schema&&t(i.schema,n)){r=!0;break}}return r}}}t.$inject=["formMarkupHelper"],e.pluginHelper=t}(t=e.services||(e.services={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(e,t,n,r,a,i,o){function s(e){var t=e.split("."),n=[t[0]];return t.length>1&&n.push(t.slice(1).join(".")),n}function l(e,t,n){var r=s(e);if(r.length>1)c(r[1],t[r[0]],n);else if(t[r[0]]){var a=t[r[0]];if(angular.isArray(a))for(var i=a.length-1;i>=0;i--){var o=typeof a[i];("undefined"===o||"object"===o&&0===Object.keys(a[i]).length)&&a.splice(i,1)}t[r[0]]=n(a)}}function c(e,t,n){if(void 0!==t)if(angular.isArray(t))for(var r=0;r<t.length;r++)l(e,t[r],n);else l(e,t,n)}function d(e,t,n,r){if(e.array){for(var a=[],i=!e.directive||w(e),o=0;o<t.length;o++){var s=t[o];s&&s.x&&(s=s.x);var l=S(s,r,n,e.name);i&&(l={x:l}),a.push(l)}return a}return e.select2?{id:t,text:S(t,r,n,e.name)}:S(t,r,n,e.name)}function u(e,t,n,r){if(e.array){for(var a=[],i=0;i<t.length;i++)a.push(x(t[i],n,r,e.name));return a}return x(t,n,r,e.name)}function f(t,n,r,a,i){var o=!n.id&&!n.newRecord;if(r.handleSchema("Main "+n.modelName,t,o?null:n.formSchema,n.listSchema,"",!0,n,i),o)i.allowLocationChange=!0;else{var s=!0;if(n.$watch("record",function(e,t){e!==t&&(s=r.updateDataDependentDisplay(e,t,s,n))},!0),n.id)"function"==typeof n.dataEventFunctions.onBeforeRead?n.dataEventFunctions.onBeforeRead(n.id,function(e){e?n.showError(e):a.readRecord(n,i)}):a.readRecord(n,i);else{if(i.master={},e.$$search.r)try{i.master=JSON.parse(e.$$search.r)}catch(l){console.log("Error parsing specified record : "+l.message)}n.phase="ready",n.cancel()}}}function m(e){return function(t,r){if(-1!==[200,400].indexOf(r)){var a="";for(var i in t.errors)if(t.errors.hasOwnProperty(i)){switch(a+="<li><b>"+n("titleCase")(i)+": </b> ",t.errors[i].type){case"enum":a+="You need to select from the list of values";break;default:a+=t.errors[i].message}a+="</li>"}a=a.length>0?t.message+"<br /><ul>"+a+"</ul>":t.message||"Error!  Sorry - No further details available.",e.showError(a)}else e.showError(r+" "+JSON.stringify(t))}}var p=function(e,t){return(e.id||"f_"+e.name).replace(/\./g,"_")+t},v=function(e,t,n){for(var r=t.split("."),a=r.length-1,i=e,o=0;a>o&&(i=angular.isArray(i)?_.map(i,function(e){return e[r[o]]}):i[r[o]],angular.isArray(i)&&n&&n.scope&&"function"==typeof n.scope&&(i=i[n.scope().$index]),i);o++);return{lastObject:i,key:i?r[a]:void 0}},g=function(e,t,n,r){var a=v(e,t,n);if(a.lastObject&&a.key)if(angular.isArray(a.lastObject))for(var i=0;i<a.lastObject.length;i++)a.lastObject[i][a.key]=r[i];else a.lastObject[a.key]=r},h=function(e,t,n){var r,a=v(e,t,n);return a.lastObject&&a.key&&(r=angular.isArray(a.lastObject)?_.map(a.lastObject,function(e){return e[a.key]}):a.lastObject[a.key]),r},b=function(e,t,n){if(!t.topLevelFormName||t[t.topLevelFormName].$pristine){l(e.name,n.master,function(n){return d(e,n,t[p(e,"Options")],t[p(e,"_ids")])});var r=h(n.master,e.name);r&&g(t.record,e.name,void 0,r)}},y=function(e,t,n){for(var r=t.split("."),a=0;a<r.length;a++)void 0!==e&&null!==e&&(e=e[r[a]]);return e&&-1!==n.indexOf(r[a-1])&&(e=e.text||e),void 0===e&&(e=""),e},w=function(e){var t=!1;return"text"===e.type?t=!0:(e.needsX||"select"===e.type&&!e.ids&&!e.directive)&&(t=!0),t},k=function(e,t,n,r,a){a=a||t;for(var i=0;i<e.length;i++){var o=e[i],s=o.name.slice(n),l=h(t,s);if(o.schema){if(l)for(var c=0;c<l.length;c++)l[c]=k(o.schema,l[c],n+1+s.length,r,a)}else{var u=y(t,s,r.select2List);if(o.array&&w(o)&&u)for(var f=0;f<u.length;f++)u[f]={x:u[f]};var m=r[p(o,"_ids")];if(l&&m&&m.length>0){if(-1!==s.indexOf("."))throw new Error("Trying to directly assign to a nested field 332");t[s]=d(o,l,r[p(o,"Options")],m)}else if(o.select2&&!o.select2.fngAjax){if(l)if(o.array)for(var v=0;v<l.length;v++)r[o.select2.s2query].query({term:l[v].x.text||l[v].text||l[v].x||l[v],callback:function(e){if(e.results.length>0)if(l[v].x){if(-1!==s.indexOf("."))throw new Error("Trying to directly assign to a nested field 342");t[s][v].x=e.results[0]}else{if(-1!==s.indexOf("."))throw new Error("Trying to directly assign to a nested field 345");t[s][v]=e.results[0]}}});else r[o.select2.s2query].query({term:l,callback:function(e){if(e.results.length>0){if(-1!==s.indexOf("."))throw new Error("Trying to directly assign to a nested field 357");t[s]=e.results[0]}}})}else if(o.select2)void o.select2;else if(l&&r.conversions[o.name]&&r.conversions[o.name].fngajax&&!r.conversions[o.name].noconvert){var b=o;r.conversions[b.name].fngajax(l,b,function(e,t){g(a,e.name,void 0,t),C(angular.element("#"+e.id),function(){g(r.record,e.name,void 0,t)})})}}}return t},x=function(e,t,n,r){var a=_.isObject(e)?e.x||e.text:e;if(a&&a.match(/^[0-9a-f]{24}$/))return a;var i=t.indexOf(a);if(-1===i)throw new Error("convertListValueToId: Invalid data - value "+a+" not found in "+t+" processing "+r);return n[i]},C=function(e,t){var n=e.inheritedData("$ngModelController"),r=n&&n.$pristine;r&&(n.$pristine=!1),t(),r&&(n.$pristine=!0)},S=function(e,t,n,r){var a=t.indexOf(e);if(-1===a)throw new Error("convertIdToListValue: Invalid data - id "+e+" not found in "+t+" processing "+r);return n[a]},$=function(e,t,n){n.master=k(t.formSchema,e,0,t),t.phase="ready",t.cancel()};return{readRecord:function(t,n){i.readRecord(t.modelName,t.id).success(function(r){r.success===!1&&e.path("/404"),n.allowLocationChange=!1,t.phase="reading","function"==typeof t.dataEventFunctions.onAfterRead&&t.dataEventFunctions.onAfterRead(r),$(r,t,n)}).error(t.handleHttpError)},scrollTheList:function(t){var n=t.pagesLoaded;i.getPagedAndFilteredList(t.modelName,{aggregate:e.$$search.a,find:e.$$search.f,limit:t.pageSize,skip:n*t.pageSize,order:e.$$search.o}).success(function(e){angular.isArray(e)?n===t.pagesLoaded?(t.pagesLoaded++,t.recordList=t.recordList.concat(e)):console.log("DEBUG: infinite scroll component asked for a page twice"):t.showError(e,"Invalid query")}).error(t.handleHttpError)},deleteRecord:function(t,n,r,o){i.deleteRecord(t,n).success(function(){"function"==typeof r.dataEventFunctions.onAfterDelete&&r.dataEventFunctions.onAfterDelete(o.master),a.redirectTo()("list",r,e)})},updateDocument:function(e,n,r,a){r.phase="updating",i.updateRecord(r.modelName,r.id,e).success(function(e){e.success!==!1?("function"==typeof r.dataEventFunctions.onAfterUpdate&&r.dataEventFunctions.onAfterUpdate(e,a.master),n.redirect?(n.allowChange&&(a.allowLocationChange=!0),t.location=n.redirect):($(e,r,a),r.setPristine(!1))):r.showError(e)}).error(r.handleHttpError)},createNew:function(n,r,o){i.createRecord(o.modelName,n).success(function(n){n.success!==!1?("function"==typeof o.dataEventFunctions.onAfterCreate&&o.dataEventFunctions.onAfterCreate(n),r.redirect?t.location=r.redirect:a.redirectTo()("edit",o,e,n._id)):o.showError(n)}).error(o.handleHttpError)},getListData:y,suffixCleanId:p,setData:g,setUpSelectOptions:function(e,t,n,r,a){var s=n[t.options]=[],l=n[t.ids]=[];o.getSchema(e).success(function(o){var c=[];a("Lookup "+e,o,null,c,"",!1,n,r);var d;"undefined"!=typeof t.filter&&t.filter?(console.log("filtering"),d=i.getPagedAndFilteredList(e,t.filter)):d=i.getAll(e),d.success(function(e){if(e){for(var a=0;a<e.length;a++){for(var i="",o=0;o<c.length;o++)i+=e[a][c[o].name]+" ";i=i.trim();var d=_.sortedIndex(s,i);s[d]===i&&(i=i+"    ("+e[a]._id+")",d=_.sortedIndex(s,i)),s.splice(d,0,i),l.splice(d,0,e[a]._id)}b(t,n,r)}})})},preservePristine:C,convertToMongoModel:function F(e,t,n,r){function a(e,t){var n;return t.select2&&t.select2.fngAjax||r.conversions[t.name]&&r.conversions[t.name].fngajax?e&&(n=e.id||e):e&&(n=e.text||(e.x?e.x.text:e)),n}for(var i=0;i<e.length;i++){var o=e[i].name.slice(n),s=y(t,o,r.select2List);if(e[i].schema){if(s)for(var c=0;c<s.length;c++)s[c]=F(e[i].schema,s[c],n+1+o.length,r)}else{if(e[i].array&&w(e[i])&&s)for(var d=0;d<s.length;d++)s[d]=s[d].x;var f=r[p(e[i],"_ids")];if(f&&f.length>0)l(o,t,function(t){return u(e[i],t,r[p(e[i],"Options")],f)});else if(r.conversions[e[i].name]){var m,v=h(t,o,null);if(e[i].array){if(m=[],v)for(var b=0;b<v.length;b++)m[b]=a(v[b],e[i])}else m=a(v,e[i]);g(t,o,null,m)}}}return t},convertIdToListValue:S,handleError:m,decorateScope:function(n,i,o,s){n.handleHttpError=m(n),n.cancel=function(){angular.copy(s.master,n.record),n.$broadcast("fngCancel",n),r(n.setPristine)},n.$on("showErrorMessage",function(e,t){n.showError(t.body,t.title)}),n.showError=function(e,t){n.alertTitle=t?t:"Error!",n.errorMessage=e},n.dismissError=function(){delete n.errorMessage,delete n.alertTitle},n.save=function(e){e=e||{};var t=o.convertToMongoModel(n.formSchema,angular.copy(n.record),0,n);n.id?"function"==typeof n.dataEventFunctions.onBeforeUpdate?n.dataEventFunctions.onBeforeUpdate(t,s.master,function(r){r?n.showError(r):o.updateDocument(t,e,n,s)}):o.updateDocument(t,e,n,s):"function"==typeof n.dataEventFunctions.onBeforeCreate?n.dataEventFunctions.onBeforeCreate(t,function(r){r?n.showError(r):o.createNew(t,e,n)}):o.createNew(t,e,n)},n.newClick=function(){a.redirectTo()("new",n,e)},n.$on("$locationChangeStart",function(e,r){if(!s.allowLocationChange&&!n.isCancelDisabled()){e.preventDefault();var a=i.open({template:'<div class="modal-header">   <h3>Record modified</h3></div><div class="modal-body">   <p>Would you like to save your changes?</p></div><div class="modal-footer">    <button class="btn btn-primary dlg-yes" ng-click="yes()">Yes</button>    <button class="btn btn-warning dlg-no" ng-click="no()">No</button>    <button class="btn dlg-cancel" ng-click="cancel()">Cancel</button></div>',controller:"SaveChangesModalCtrl",backdrop:"static"});a.result.then(function(e){e?n.save({redirect:r,allowChange:!0}):(s.allowLocationChange=!0,t.location=r)})}}),n.deleteClick=function(){if(n.record._id){var e=i.open({template:'<div class="modal-header">   <h3>Delete Item</h3></div><div class="modal-body">   <p>Are you sure you want to delete this record?</p></div><div class="modal-footer">    <button class="btn btn-primary dlg-no" ng-click="cancel()">No</button>    <button class="btn btn-warning dlg-yes" ng-click="yes()">Yes</button></div>',controller:"SaveChangesModalCtrl",backdrop:"static"});e.result.then(function(e){e&&("function"==typeof n.dataEventFunctions.onBeforeDelete?n.dataEventFunctions.onBeforeDelete(s.master,function(e){e?n.showError(e):o.deleteRecord(n.modelName,n.id,n,s)}):o.deleteRecord(n.modelName,n.id,n,s))})}},n.isCancelDisabled=function(){return"function"==typeof n.disableFunctions.isCancelDisabled?n.disableFunctions.isCancelDisabled(n.record,s.master,n[n.topLevelFormName]):n[n.topLevelFormName]&&n[n.topLevelFormName].$pristine},n.isSaveDisabled=function(){return"function"==typeof n.disableFunctions.isSaveDisabled?n.disableFunctions.isSaveDisabled(n.record,s.master,n[n.topLevelFormName]):n[n.topLevelFormName]&&(n[n.topLevelFormName].$invalid||n[n.topLevelFormName].$pristine)},n.isDeleteDisabled=function(){return"function"==typeof n.disableFunctions.isDeleteDisabled?n.disableFunctions.isDeleteDisabled(n.record,s.master,n[n.topLevelFormName]):!n.id},n.isNewDisabled=function(){return"function"==typeof n.disableFunctions.isNewDisabled?n.disableFunctions.isNewDisabled(n.record,s.master,n[n.topLevelFormName]):!1},n.disabledText=function(e){var t="";return n.isSaveDisabled&&(t="This button is only enabled when the form is complete and valid.  Make sure all required inputs are filled in. "+e),t},n.getVal=function(e,t){return-1===e.indexOf("$index")||"undefined"!=typeof t?(e=e.replace(/\$index/g,t),n.$eval("record."+e)):void 0}},fillFormFromBackendCustomSchema:f,fillFormWithBackendSchema:function(e,t,n,r){o.getSchema(e.modelName,e.formName).success(function(a){f(a,e,t,n,r)}).error(e.handleHttpError)}}}t.$inject=["$location","$window","$filter","$timeout","routingService","SubmissionsService","SchemasService"],e.recordHandler=t}(t=e.services||(e.services={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(e){return{getSchema:function(t,n){return e.get("/api/schema/"+t+(n?"/"+n:""),{cache:!0})}}}t.$inject=["$http"],e.SchemasService=t}(t=e.services||(e.services={}))}(fng||(fng={}));var fng;!function(e){var t;!function(e){function t(e,t){var n=function(e){var t="",n=function(e,n){void 0!==n&&""!==n&&("object"==typeof n&&(n=JSON.stringify(n)),""===t?t="?":t+="&",t+=e+"="+n)};return n("l",e.limit),n("f",e.find),n("a",e.aggregate),n("o",e.order),n("s",e.skip),t};return{getListAttributes:function(t,n){return e.get("/api/"+t+"/"+n+"/list")},readRecord:function(t,n){return e.get("/api/"+t+"/"+n)},getAll:function(t,n){var r=angular.extend({cache:!0},n);return e.get("/api/"+t,r)},getPagedAndFilteredList:function(t,r){return e.get("/api/"+t+n(r))},deleteRecord:function(t,n){return e["delete"]("/api/"+t+"/"+n)},updateRecord:function(n,r,a){return t.get("$http").remove("/api/"+n),e.post("/api/"+n+"/"+r,a)},createRecord:function(n,r){return t.get("$http").remove("/api/"+n),e.post("/api/"+n,r)}}}t.$inject=["$http","$cacheFactory"],e.SubmissionsService=t}(t=e.services||(e.services={}))}(fng||(fng={}));var fng;!function(e){e.formsAngular=angular.module("formsAngular",["ngSanitize","ngMessages","ui.bootstrap","infinite-scroll","monospaced.elastic"]).controller("BaseCtrl",e.controllers.BaseCtrl).controller("SaveChangesModalCtrl",e.controllers.SaveChangesModalCtrl).controller("ModelCtrl",e.controllers.ModelCtrl).controller("NavCtrl",e.controllers.NavCtrl).directive("modelControllerDropdown",e.directives.modelControllerDropdown).directive("errorDisplay",e.directives.errorDisplay).directive("fngLink",e.directives.fngLink).directive("formInput",e.directives.formInput).directive("formButtons",e.directives.formButtons).directive("globalSearch",e.directives.globalSearch).filter("camelCase",e.filters.camelCase).filter("titleCase",e.filters.titleCase).service("addAllService",e.services.addAllService).provider("cssFrameworkService",e.services.cssFrameworkService).provider("routingService",e.services.routingService).factory("$data",e.services.$data).factory("formGenerator",e.services.formGenerator).factory("formMarkupHelper",e.services.formMarkupHelper).factory("inputSizeHelper",e.services.inputSizeHelper).factory("pluginHelper",e.services.pluginHelper).factory("recordHandler",e.services.recordHandler).factory("SchemasService",e.services.SchemasService).factory("SubmissionsService",e.services.SubmissionsService)}(fng||(fng={}));var formsAngular=fng.formsAngular;angular.module("formsAngular").run(["$templateCache",function(e){e.put("base-analysis.html",'<div ng-controller="AnalysisCtrl">\n  <div class="container-fluid page-header report-header">\n    <div ng-class="css(\'rowFluid\')">\n      <div class="header-lhs col-xs-7 span7">\n        <h1>{{ reportSchema.title }}</h1>\n      </div>\n      <div class="header-rhs col-xs-5 span5">\n        <form-input schema="paramSchema" name="paramForm" ng-show="paramSchema" formstyle="horizontalCompact"></form-input>\n      </div>\n    </div>\n  </div>\n  <div class="container-fluid page-body report-body">\n    <error-display></error-display>\n    <div class="row-fluid">\n      <div class="gridStyle" ng-grid="gridOptions"></div>\n    </div>\n  </div>\n</div>\n'),e.put("base-edit.html",'<div ng-controller="BaseCtrl">\n    <div ng-class="css(\'rowFluid\')" class="page-header edit-header">\n        <div class="header-lhs col-sm-8 span8">\n            <h4>{{modelNameDisplay}} :\n                <span ng-repeat="field in listSchema">{{getListData(record, field.name)}} </span>\n            </h4>\n        </div>\n        <div class="header-rhs col-sm-2 span2">\n            <div form-buttons></div>\n        </div>\n    </div>\n    <div class="container-fluid page-body edit-body">\n        <error-display></error-display>\n        <form-input name="baseForm" schema="baseSchema()" formstyle="compact"></form-input>\n    </div>\n</div>\n'),e.put("base-list.html",'<div ng-controller="BaseCtrl">\n    <div ng-class="css(\'rowFluid\')" class="page-header list-header">\n        <div class="header-lhs col-sm-8 span8">\n            <h1>{{modelNameDisplay}}</h1>\n        </div>\n        <div class="header-rhs col-sm-2 span2">\n            <a ng-href="{{generateNewUrl()}}"><button id="newBtn" class="btn btn-default"><i class="icon-plus"></i> New</button></a>\n        </div>\n    </div>\n    <div class="page-body list-body">\n        <error-display></error-display>\n        <div ng-class="css(\'rowFluid\')" infinite-scroll="scrollTheList()">\n            <a ng-repeat="record in recordList" ng-href="{{generateEditUrl(record)}}">\n                <div class="list-item">\n                    <div ng-class="css(\'span\',12/listSchema.length)" ng-repeat="field in listSchema">{{getListData(record, field.name)}} </div>\n                </div>\n            </a>\n        </div>\n    </div>\n</div>\n'),e.put("error-messages.html",'<div ng-message="required">A value is required for this field</div>\n<div ng-message="minlength">Too few characters entered</div>\n<div ng-message="maxlength">Too many characters entered</div>\n<div ng-message="min">That value is too small</div>\n<div ng-message="max">That value is too large</div>\n<div ng-message="email">You need to enter a valid email address</div>\n<div ng-message="pattern">This field does not match the expected pattern</div>\n'),e.put("form-button-bs2.html",'<div class="form-btn-grp">\n  <div class="btn-group pull-right">\n    <button id="saveButton" class="btn btn-mini btn-primary form-btn" ng-click="save()" ng-disabled="isSaveDisabled()"><i class="icon-ok"></i> Save</button>\n    <button id="cancelButton" class="btn btn-mini btn-warning form-btn" ng-click="cancel()" ng-disabled="isCancelDisabled()"><i class="icon-remove"></i> Cancel</button>\n  </div>\n  <div class="btn-group pull-right">\n    <button id="newButton" class="btn btn-mini btn-success form-btn" ng-click="newClick()" ng-disabled="isNewDisabled()"><i class="icon-plus"></i> New</button>\n    <button id="deleteButton" class="btn btn-mini btn-danger form-btn" ng-click="deleteClick()" ng-disabled="isDeleteDisabled()"><i class="icon-minus"></i> Delete</button>\n  </div>\n</div>\n'),e.put("form-button-bs3.html",'<div class="form-btn-grp">\n  <div class="btn-group pull-right">\n    <button id="saveButton" class="btn btn-primary form-btn btn-xs" ng-click="save()" ng-disabled="isSaveDisabled()"><i class="glyphicon glyphicon-ok"></i> Save</button>\n    <button id="cancelButton" class="btn btn-warning form-btn btn-xs" ng-click="cancel()" ng-disabled="isCancelDisabled()"><i class="glyphicon glyphicon-remove"></i> Cancel</button>\n  </div>\n  <div class="btn-group pull-right">\n    <button id="newButton" class="btn btn-success form-btn btn-xs" ng-click="newClick()" ng-disabled="isNewDisabled()"><i class="glyphicon glyphicon-plus"></i> New</button>\n    <button id="deleteButton" class="btn btn-danger form-btn btn-xs" ng-click="deleteClick()" ng-disabled="isDeleteDisabled()"><i class="glyphicon glyphicon-minus"></i> Delete</button>\n  </div>\n</div>\n'),e.put("search-bs2.html",'<form class="navbar-search pull-right">\n    <div id="search-cg" class="control-group" ng-class="errorClass">\n        <input type="text" autocomplete="off" id="searchinput" ng-model="searchTarget" ng-model-options="{debounce:250}" class="search-query" placeholder="{{searchPlaceholder}}" ng-keyup="handleKey($event)">\n    </div>\n</form>\n<div class="results-container" ng-show="results.length >= 1">\n    <div class="search-results">\n        <div ng-repeat="result in results">\n            <span ng-class="resultClass($index)" ng-click="selectResult($index)">{{result.resourceText}} {{result.text}}</span>\n        </div>\n        <div ng-show="moreCount > 0">(plus more - continue typing to narrow down search...)\n        </div>\n    </div>\n</div>\n'),
e.put("search-bs3.html",'<form class="pull-right navbar-form">\n    <div id="search-cg" class="form-group" ng-class="errorClass">\n        <input type="text" autocomplete="off" id="searchinput" ng-model="searchTarget" ng-model-options="{debounce:250}" class="search-query form-control" placeholder="{{searchPlaceholder}}" ng-keyup="handleKey($event)">\n    </div>\n</form>\n<div class="results-container" ng-show="results.length >= 1">\n    <div class="search-results">\n        <div ng-repeat="result in results">\n            <span ng-class="resultClass($index)" ng-click="selectResult($index)" title={{result.additional}}>{{result.resourceText}} {{result.text}}</span>\n        </div>\n        <div ng-show="moreCount > 0">(plus more - continue typing to narrow down search...)\n        </div>\n    </div>\n</div>\n')}]);